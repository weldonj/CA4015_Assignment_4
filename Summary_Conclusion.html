
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Summary &#8212; CA4015 Assignment 3 - Time Series Forecasting - Jack Boylan, John Weldon</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Multivariate Time Series Forecasting" href="SecondPage.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/forecasting.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">CA4015 Assignment 3 - Time Series Forecasting - Jack Boylan, John Weldon</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro_and_Desc_of_Data.html">
   Literature Review and Motivations for Forecasting Stage
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  First Notebook
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="FirstPage.html">
   Univariate Time Series Forecasting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FirstPage.html#univariate-assuming-data-all-belongs-to-one-subject">
   Univariate Assuming Data All Belongs To One Subject
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Second Notebook
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="SecondPage.html">
   Multivariate Time Series Forecasting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SecondPage.html#rest-of-night-prediction-for-individual-patients">
   Rest of Night Prediction for Individual patients
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SecondPage.html#repeating-with-original-features">
   Repeating with Original Features
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SecondPage.html#conclusion">
   Conclusion
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Concluding Section
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Summary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#learning-outcomes">
   Learning Outcomes
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Summary_Conclusion.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Summary
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-outcomes">
   Learning Outcomes
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>With the shorter deadline and having a nice, clean dataset that we had already processed in Assignment 2, we iniitally though that this forecasting assignment would be fairly straight forward. We quickly realised that this wouldn’t be the case after some initial attempts to do some univariate forecasting.</p>
<p>The thought process for our initial steps was to take each subject individually and try to forecast how their sleep cycle would develop throughout the night. It dawned on us, however, that we actually had very little data on a “per subect” basis. We only have 1 sleep cycle per person and so any attempt to split that cycle into training/test sets leaves a glaring hole in what the model can actually learn. For example, if you do an 80/20 split with the 20 being the last 20 percent of the cycle, the model can only assume that the person will never wake up as it has never seen a “waking up” event.</p>
<p>This meant that our first Univariate forecasting, using Facebook’s time series forecasting package fbprophet, was particularly poor. We saw that what basically happens is the model uses the previous trend to predict where the sleep cycle would go. This isn’t an awful idea but we found that it essentially meant our subject would head towards sleep stage 5 and stay there (never waking up) or somewhat rapidly move towards 0 (awake). This doesn’t reflect at all how the sleep cycles actually work, with subjects likely to move between various stages throughout the night before they all eventually wake.</p>
<p>We decided that we would make the assumption that the first 30 subjects sleep cycles were in fact the previous 30 nights sleep for the 31st subject. In effect, creating a month’s worth of sleep for a single subject. This allowed us to give actual full cycles to the training model. We found that this improved the model signifcantly as we might expect, though it still wasn’t very impressive. We hypothesized that univariate was really limiting us in our training, and that it was time to move on and use the 270+ features that we had extracted from the sleep cycle data in the previous Assignment.</p>
<p>Our first step in this multi variate process to create a baseline prediction performance. We achieved this by splitting our data into training and testing sets, and predicting the labels of future rows based on the last label in the training data. This is obviously quite primitive but allowed us to see if our model could outperform even this basic baseline performance.</p>
<p>We then tried out a Random Forest Regression model and took note of how it performed, noting that it was an immediate large improvement on this previous baseline.</p>
<p>Gradient Boosted Trees was the next choice that we went with, it relies on using ensemble techniques to combine weak classifiers - such as decision trees - into a better model. Once more we noted that this improved our error.</p>
<p>In these previous multivariate models, we had been predicting the future sleep stages of all patients whereas in real world applications we would likely only be predicting the sleep of one subject. As in the Univaraite modeling, the training data will never show the model that a patient eventually stops sleeping. Therefore, the model will simply predict that each patient sleeps for as long as it is asked to predict.</p>
<p>To solve this set aside a number of patients as “test” subjects. The rest of the patients were once combined as if they were one, with each sleep cycle following after another.</p>
<p>We created a model for each subject, using the full training data and a portion of the test subject’s sleep data. We thenattempted to predict the rest of the subject’s sleep stages for that night.</p>
<p>We compared the performance of multiple models here and found that the best performing algorithms were Linear Regression and Support Vector Regression. We wanted to do some cross validation next, and though we would like to have chosen one of these two for this process, the time they take was too long. We went with the Random Forest Regressor instead.</p>
<p>In the previous classification assignemnt, we had noted that the use of the original windowed features provided classifiers that performed almost as well as models trained on extracted features. We decided to do the same here, and examine the performance of forecasting models using only the original features. Once again we compared the performance of multiple algorithms and this time Support Vector Regression edged slightly ahead of Linear Regression as the best choice. This time we chose Random Forest and K Nearest Neighbours for cross validation as once again, support vector regression was far too time consuming and also linear regression doesn not have enough hyperparameters to find.</p>
<p>We saw that models trained using the extracted features dataset generally perform better than those trained on the original features. However, both approaches struggle with forecasting the beginning and end of a sleep cycle. This may be due to the fact that we have concatenated different people’s sleep data together, all with different charactersitics that the model has difficulty consolidating into a recognisable pattern.</p>
<p>It is also interesting to note that different models work better for different subjects. Future work could be done in this area, whereby multiple nights’ sleep are recorded per subject, and a comparison of each model could be carried out to identify a significantly superior algorithm.</p>
</div>
<div class="section" id="learning-outcomes">
<h1>Learning Outcomes<a class="headerlink" href="#learning-outcomes" title="Permalink to this headline">¶</a></h1>
<p>In terms of what we learned throughout the process, once more the assignment proved quite valuable. We approached it initially somewhat naively, and underestimated what would be involved. But through lots of trial and error and a lot of internet searches and banging our heads against the wall we managed to get what we feel are some useful results. It would have been nice to have lots of data for each subject but we had to make do with what we had. As in previous assignments, it seems likely that this will be mirrored somewhat in industry, and that the data that we get to work with will never be perfect for our use case.</p>
<p>With this in mind, the assignment has undoubtedly aided in preparing us for future tasks both in this final year and once we go into employment. We look forward to whatever challenges assignment 4 might bring.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="SecondPage.html" title="previous page">Multivariate Time Series Forecasting</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>